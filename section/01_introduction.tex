\chapter{序論}
\label{chap:introduction}
\section{本論文の背景}
ゲームAIによる昨今の成果として、囲碁や将棋などのゲームでは、人間のチャンピオンレベルの実力に至っている。一方、麻雀においては未だそれに及んでいない。麻雀という競技は、多人数不完全情報ゲームに分類され、多人数性による複雑性と不完全情報による不確定性を理由に、適切なモデルを制作することが非常に難しいからである。例えば、囲碁などで利用されるゲーム木探索の手法も、以上の理由により麻雀にはそのまま適用することが出来ない。したがって、麻雀においては問題を部分ごとに取り出し、簡単な問題にしてからそれぞれを研究する必要がある。麻雀には、大きく分けて攻めと守りの戦略が存在するが、本論文では攻めの戦略について述べる。攻めの中でも、得点するために必要な和了率は非常に重要な指標であり、これを高めるための研究が数多く報告されている。和了率を高めるための研究としては大きく分けて、途中局面のヒューリスティクスを用いた方法、強者の牌譜を学習してモデルを作る方法、モンテカルロ法によるシミュレーションを用いた方法があげられる。この中で、本研究では特に途中局面のヒューリスティクスを用いた方法において、既存手法の課題を解決する手法を提案する。

\section{本論文が着目する課題}
途中局面のヒューリスティクスを用いて和了率を高めるように打牌するアルゴリズムとしては、シャンテン数を下げるように打つ方法、有効牌を最大にするように打つ方法が挙げられる。シャンテン数とは和了までの距離を表す指標で、小さいほど和了に近く、和了しやすいことを示す。したがって、与えられた牌姿１４枚の中からそれぞれを打牌した場合のシャンテン数を全て計算し、最もシャンテン数が小さくなるような牌を選択するのが、最も簡単なシャンテン数を下げるように打つアルゴリズムである。しかしこの方法では、一般にシャンテン数が最も小さくなる牌は複数存在するため、その中からランダムで打牌を選択することになる。シャンテン数が最も小さくなる牌の中でも優劣は存在し、これが成績を分ける場合も多い。そのため、それらの中での優劣をつけるために一般に知られている方法が、有効牌の数を比較するという方法である。有効牌とは手牌に加えたときにシャンテン数を下げる牌の集合であり、この数が多くなるような打牌を選択することは和了率上昇につながる。しかし、この方法にはいくつかの問題点がある。一つは、有効牌の数が多いことは確かにシャンテン数を下げることを促すが、実際は有効牌にはそれぞれ種類が存在するため、数だけで比較すると正確な和了率の評価になっていない部分があることである。これは、有効牌の数が同数であっても和了率には差があることを示し、さらには有効牌の数が小さくなる選択を選んだほうが和了率が上がってしまうケースも存在することがわかっている。もう一つの問題は、この方法では目先の有効牌の数しか比較していないところである。確かに、シャンテン数を下げる牌の中から有効牌が最大になるような牌を選択することで、その瞬間次のシャンテン数を早く下げることが有利な状況になる。しかし長期的に見たときに、和了率において有利かどうかは、その瞬間の有効牌の数の比較だけではわからないことである。
% １人麻雀においてある局面からゲーム木を展開しようとした場合、次にどの種類牌をツモるかはわからないため、ランダムに決定しノードを展開していくことになる。これを繰り返し行うと探索空間が大きくなりすぎるため、手の選択が難しくなる。これを対処するために、あらゆる手法が提案されている。このような場合に木を展開せずに有望な手を選択する手法として、Upper Confidence Bound (UCB) \cite{UCB}がある。UCB ではある局面から考えられる全ての手に対して, よい結果 を返しそうな手を重視しつつ、何度もプレイアウトと呼ば れるランダムシミュレーションを行うことで 最善の手を決定する手法である。
% UCB は局面ごとにこの探索を実行するが, 各局面を完全 に別の局面として扱うため他の局面の探索において得た情 報を利用することができない。この問題を解決するためにLinear UCB (LinUCB) \cite{LinUCB} という手法が提案されている。これは、局面を特徴で表す ことで、対象とする局面が異なっても, それまで対象とした局面の情報を利用できるといったものである。
% これらは麻雀について適用した例が報告されている\cite{LinUCB_mahjong}が、いずれの方法も平均プレイヤーに満たない成績となった。

% % しかし、UCB1 と LinUCB の評価値計算において信頼度の 計算式が異なることや、特徴量の設計に問題があるなどの理由でいい結果は出ていなかった。 
% 本研究では、モンテカルロ法の問題点である、麻雀に適用すると探索空間が大きくなりすぎてうまく適用出来ない問題に対して、探索空間を小さくするために、２つの解決策を行う。一つはモンテカルロ法のシミュレーションを直接牌姿に当てはめるのではなく、牌姿ごとの局面で数理的に比較できる内容を数理計算を用い削減する方法である。もう一つは、三向聴以下に対してはシャンテン数を下げるように打ち、モンテカルロ法を用いる部分を限定する方法である。麻雀の牌理に関しては、上がりに近づく選択ほど重要である\cite{gendai}ため、聴牌に近い打牌選択においてモンテカルロ法を適用することで、成績に影響を大きく与える部分でモンテカルロ法の効果が発揮できることが期待される。
\section{本論文の目的}
本研究では、期待和了巡目として定義する指標を用いて、和了率を高めるための打牌アルゴリズムを提案する。この手法では、与えられた牌姿におけるシャンテン数を下げる牌の中から、理論値として和了までの平均消費巡目を計算することよって、それらの牌を比較する。これにより、前節で上げた課題である、有効牌による比較アルゴリズムの問題点を解決し、和了率を改善することを目的とする。評価として、多人数性を取り除いた１人麻雀の成績と、通常の４人麻雀の成績を扱う。１人麻雀では相手プレイヤーが存在しないため、和了率を求めた打牌アルゴリズム同士の比較が精密に行えると期待できる。したがって１人麻雀では、本研究の提案手法による打牌アルゴリズムが、先に示したアルゴリズムよりも和了率として優る結果を出すことを目的とする。４人麻雀では相手プレイヤーが存在するため、和了率以外の項目でも成績に影響する要素が複雑にある。そのため、４人麻雀でも和了率が高くなることを示すことを目的とするが、その他の成績においては主に分析に利用する。
\section{本論文の構成}
本論文の構成について述べる。
\\\ref{chap:relevantstudy}章では、ゲームAIの研究、麻雀研究の一般論について述べる。
\\\ref{chap:approach}章では、期待和了巡目を定義し、それによって和了率を上げるための打牌を選択するアルゴリズムを提案する。
\\\ref{chap:evaluation}章では、\ref{chap:approach}章で提案した手法で実装したアルゴリズムのAIを１人麻雀を打たせ、和了率を評価する。また、４人麻雀で打った際の成績も評価する。
\\\ref{chap:conclusion}章では、本手法によって得られた知見について述べる。
